<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>SportPlanner AI - Fuentes de datos</title>
    <style>
        body {
            margin: 0;
            font-family: 'Roboto', sans-serif;
            background-color: #f4f7f6;
            color: #333;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }

        iframe {
            width: 100%;
            border: none;
            border-radius: 10px;
        }

        .iframe-wrapper {
            width: 100%;
            height: 150px; /* Altura visible reducida */
            overflow: hidden;
            position: relative;
            margin-bottom: 5px;
        }

        .iframe-wrapper iframe.bergfex {
            height: 1000px;
            position: absolute;
            top: -150px;
        }

        .full-screen-nav {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .full-screen-nav h3 {
            background-color: #007bff;
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 5px;
            text-align: center;
            font-size: 1.2em;
        }

        .full-screen-nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .full-screen-nav li {
            background-color: #ffffff; /* Default background for all list items */
            margin-bottom: 8px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            transition: background-color 0.3s ease; /* Smooth transition for color changes */
        }

        /* Styles for the new color classes */
        .full-screen-nav li.bueno {
            background-color: #4CAF50; /* Green */
        }

        .full-screen-nav li.malo {
            background-color: #F44336; /* Red */
        }

        .full-screen-nav li a {
            display: flex; /* Use flexbox to align name and value */
            justify-content: space-between; /* Push name to left, value to right */
            align-items: center; /* Vertically center them */
            padding: 15px;
            text-decoration: none;
            color: #007bff;
            font-weight: bold;
            transition: color 0.3s ease; /* Smooth transition for text color */
        }

        /* Adjust link color for better contrast on colored backgrounds */
        .full-screen-nav li.bueno a,
        .full-screen-nav li.malo a {
            color: white; /* White text on colored backgrounds */
        }

        .full-screen-nav li a:hover,
        .full-screen-nav li a:active {
            background-color: #e9f5ff;
            color: #0056b3;
        }

        /* Re-adjust hover for colored buttons */
        .full-screen-nav li.bueno a:hover,
        .full-screen-nav li.malo a:hover {
            background-color: rgba(255, 255, 255, 0.2); /* Slightly transparent white on hover */
        }

        /* Style for the wind value display */
        .wind-value {
            font-weight: normal; /* Make the value less bold than the station name */
            font-size: 0.9em;
            color: inherit; /* Inherit color from parent 'a' tag */
            margin-left: 10px; /* Spacing between name and value */
            min-width: 70px; /* Ensure space for values and " nudos" */
            text-align: right; /* Align value to the right */
        }


        footer {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            color: #777;
            font-size: 0.9em;
            border-top: 1px solid #eee;
        }

        @media (max-width: 768px) {
            body {
                font-size: 16px;
            }

            .container {
                padding: 15px;
            }

            .full-screen-nav h3 {
                font-size: 1.1em;
                padding: 12px 10px;
            }

            .full-screen-nav li a {
                padding: 12px;
            }
        }
    </style>
</head>
<body>
    <main class="container">
        <!-- Mapa Windy -->
        <iframe src="https://embed.windy.com/embed.html?type=map&location=coordinates&metricRain=default&metricTemp=default&metricWind=kt&zoom=9&overlay=wind&product=ecmwf&level=surface&lat=28.284&lon=-16.507&message=true" height="300" allowfullscreen></iframe>

        <!-- Gráfico de Bergfex recortado -->
        <div class="iframe-wrapper">
            <iframe class="bergfex" src="https://cabezo.bergfex.at/"></iframe>
        </div>

        <nav class="full-screen-nav">
            <h3>Viento</h3>
            <ul>
                <li><a href="https://www.windy.com/28.053/-16.524?27.778,-16.524,9"><span>Windy</span></a></li>
                <li id="cabezo_item">
                    <a href="https://cabezo.bergfex.at/">
                        <span>Cabezo</span> 
                        <span class="wind-value">--</span> <!-- Placeholder for wind value -->
                    </a>
                </li>
                <li id="puertitoguimar_item">
                    <a href="https://holfuy.com/es/weather/1818">
                        <span>Puertito de Guímar</span> 
                        <span class="wind-value">--</span> <!-- Placeholder for wind value -->
                    </a>
                </li>
                <li id="ladera_item">
                    <a href="https://holfuy.com/en/weather/1816">
                        <span>Ladera Güimar (parapente)</span> 
                        <span class="wind-value">--</span> <!-- Placeholder for wind value -->
                    </a>
                </li>
                <li id="corona_item">
                    <a href="https://holfuy.com/en/weather/1819">
                        <span>La Corona (parapente)</span> 
                        <span class="wind-value">--</span> <!-- Placeholder for wind value -->
                    </a>
                </li>
                <li><a href="https://holfuy.com/en/weather/1817"><span>Puerto de la Cruz (parapente)</span></a></li>
            </ul>

            <h3>Olas</h3>
            <ul>
                <li><a href="https://es.surf-forecast.com/breaks/Playadel-Sorocco/forecasts/latest/six_day">Norte de Tenerife</a></li>
                <li><a href="https://es.surf-forecast.com/breaks/El-Medano/forecasts/latest/six_day">Sur de Tenerife</a></li>
                <li><a href="https://es.surf-forecast.com/breaks/El-Conquistador/forecasts/latest/six_day">Oeste de Tenerife</a></li>
            </ul>

            <h3>Webcams</h3>
            <ul>
                <li><a href="https://www.skylinewebcams.com/es/webcam/espana/canarias/santa-cruz-de-tenerife/playa-el-cabezo.html">Playa El Cabezo</a></li>
                <li><a href="https://www.skylinewebcams.com/es/webcam/espana/canarias/santa-cruz-de-tenerife/surf-kitesurf-medano.html">Surf Kitesurf Médano</a></li>
                <li><a href="https://www.skylinewebcams.com/es/webcam/espana/canarias/santa-cruz-de-tenerife/el-medano-playa-la-tejita.html">Playa La Tejita</a></li>
                <li><a href="https://www.skylinewebcams.com/es/webcam/espana/canarias/santa-cruz-de-tenerife/la-caleta-costa-adeje.html">La Caleta</a></li>
                <li><a href="https://www.skylinewebcams.com/es/webcam/espana/canarias/santa-cruz-de-tenerife/playa-troya.html">Playa Troya</a></li>
                <li><a href="https://www.skylinewebcams.com/es/webcam/espana/canarias/santa-cruz-de-tenerife/punta-del-hidalgo.html">Punta del Hidalgo</a></li>
                <li><a href="https://www.skylinewebcams.com/es/webcam/espana/canarias/santa-cruz-de-tenerife/candelaria.html">Candelaria</a></li>
                <li><a href="https://www.skylinewebcams.com/es/webcam/espana/canarias/santa-cruz-de-tenerife/el-sauzal.html">El Sauzal</a></li>
            </ul>

            <h3>La lista de Greg</h3>
            <ul>
                <li><a href="https://izana.aemet.es/meteorological-data-graphs/">Izaña (parapente)</a></li>
                <li><a href="https://tablademareas.com/es/islas-canarias/el-medano#_mareas">Mareas</a></li>
                <li><a href="https://www.windguru.cz/172024">Windguru Punta del Hidalgo</a></li>
                <li><a href="https://www.windguru.cz/49357">Windguru Médano</a></li>
                <li><a href="https://www.windguru.cz/140993">Windguru Puertito Güimar</a></li>
                <li><a href="https://www.windguru.cz/103501">Windguru Puerto Cruz</a></li>
            </ul>
        </nav>
    </main>
    <footer>
        <p>&copy; 2025 Paul MacRound</p>
    </footer>

    <script>
        // !! IMPORTANT !!
        // Replace 'YOUR_APPS_SCRIPT_WEB_APP_URL_HERE' with the actual URL you got from deploying your Google Apps Script.
        const GOOGLE_APPS_SCRIPT_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbwJ3cxwXE2imToptstrnC53RORLapMObXGdKi0QYy6ZOqZ7Fh5djqgeKZ-lsLAO_CQEzQ/exec'; 

        // Mapping between the station names in your Apps Script response
        // and the HTML list item IDs.
        const stationMap = {
            "Cabezo": "cabezo_item",
            "Puertito de Guímar": "puertitoguimar_item",
            "Ladera Güimar (parapente)": "ladera_item",
            "La Corona (parapente)": "corona_item"
        };

        async function updateStationData() {
            try {
                const response = await fetch(GOOGLE_APPS_SCRIPT_WEB_APP_URL);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                console.log("Datos recibidos de Apps Script:", data); // For debugging

                for (const stationName in data) {
                    const listItemId = stationMap[stationName];
                    const stationInfo = data[stationName]; // Get the object {status: "bueno", value: "10 kt"}

                    if (listItemId && stationInfo) { // Check if we have a mapping and valid data
                        const listItem = document.getElementById(listItemId);
                        if (listItem) {
                            // Update color based on status
                            listItem.classList.remove('bueno', 'malo'); // Clear previous colors
                            listItem.classList.add(stationInfo.status); // Add the new color class

                            // Update wind value
                            const windValueSpan = listItem.querySelector('.wind-value');
                            if (windValueSpan) {
                                // Check if the value is a number before appending " nudos"
                                const valueAsNumber = parseFloat(stationInfo.value);
                                const valueText = isNaN(valueAsNumber) ? '--' : `${valueAsNumber} nudos`;
                                windValueSpan.textContent = valueText;
                            }
                        }
                    }
                }

            } catch (error) {
                console.error('Error fetching station data:', error);
                // Optionally, set buttons to a 'default' or 'error' state if data fetching fails
                // For example, set all mapped buttons to a grey background and "--" value
                for (const stationName in stationMap) {
                    const listItem = document.getElementById(stationMap[stationName]);
                    if (listItem) {
                        listItem.classList.remove('bueno', 'malo'); // Clear previous colors
                        listItem.style.backgroundColor = '#ccc'; // Grey for error/default
                        const windValueSpan = listItem.querySelector('.wind-value');
                        if (windValueSpan) {
                            windValueSpan.textContent = '--';
                        }
                    }
                }
            }
        }

        // Initial call to update button colors and values when the page loads
        updateStationData();

        // Periodically update button colors and values (e.g., every 30 seconds)
        // Adjust the interval (in milliseconds) based on how frequently you want updates.
        // 30 * 1000 = 30 seconds
        setInterval(updateStationData, 30 * 1000); 
    </script>
</body>
</html>
